---
title-block-banner: true
title-block-style: default
title: "University of West Florida"
subtitle: "Time Series Analysis STA 6856 | Professor Dr.Tharindu De Alwis "
date: 10/05/2025
date-format: full
author: "Edwin Quijano"
description: "Assignment 2"
format: pdf
editor: visual
toc: false
execute:
  echo: TRUE
  warning: FALSE
  message: FALSE
---

```{r echo=FALSE}
# Load Libraries

library(ggplot2)
library(dplyr)
library(readr)
library(lubridate)
library(scales)
library(broom)
library(zoo)
library(lmtest)
library(tseries)
library(itsmr) #for trend function
```

### 1. (10 points) Identify the following as specific ARMA models. That is, what are $p$, $q$, and what are the values of the parameters (the $\phi$ ’s and $\theta$ ’s)

#### (a) $Y_t = Y_{t−1} − 0.25Y_{t−2} + e_t − 0.1e_{t−1}$

$AR(p)=$ values of $Y_t$ $MA(q)=$ White Noise $e_t$

ARMA(2,1)

$Y\text{ lag}=p=2$

$e \text { lag}=q=1$

$\phi_1=1, \phi_2=-0.25$

$\theta_1=-0.1$

#### (b) $Y_t = 0.5Y_{t−1} − 0.5Y_{t−2} + e_t − 0.5e_{t−1} + 0.25e_{t−2}$

$AR(p)=$ values of $Y_t$ $MA(q)=$ White Noise $e_t$

ARMA(2,1)

$Y\text{ lag}=p=2$

$e \text { lag}=q=2$

$\phi_1=0.5, \phi_2=-0.5$ $\theta_1=-0.5. \theta_2=0.25$

\pagebreak

### 2. (10 points) Consider the following time series model

$Y_t = 0.64Y_{t−2} + e_t − 0.8e_{t−1}$

#### (a) Characterize this model as models in the ARMA(p,q) family, that is identify p and q.

ARMA(2,1)

$Y\text{ lag}=p=2$

$e \text { lag}=q=1$

$\phi_1=0, \phi_2=-0.64$

$\theta_1=-0.8$

#### (b) Is this model causal? Is this model a stationary model?

$$\phi B=1- \phi_1B- \phi B_2=1-0.64 B^2=\phi_1 =0 , \phi_2 =0.64 $$

$$\theta B=1+\theta_1=1-0.8B= \theta _1 = 0.8$$

$$1-0.64z^2=0$$ $$z^2={1\over 0.64}=1.56=z=\pm 1.25$$

AR is Causal and stationary, modulos $= 1.25 > 1$

\pagebreak

### 3. (10 points) Consider the following time series model

$(1 − 0.8B)(1 − 1.2B)(1 − B)Y_t = e_t$

#### (a) Is this model can be characterized as models in the ARMA(p,q) family? if so, then identify p and q.

This is an ARIMA(2,1,0) since, $(1-0.8B)(1-1.2B)=Y_t=e_t$

#### (b) Is this series stationary?

Not stationary,

$$B={1 \over 0.8}=1.25$$

$$B={1 \over 1.2}=0.83$$

$$B=1$$

\pagebreak

### 4. (10 points) Suppose that $Y_t$ follows the ARMA(1,1) model, $(1 − \phi B)Y_t = (1 − \theta B)e_t$, where e_t is a white noise. Let $X_t = (1 − \tau B)Y_t$. What is the model for $X_t$, that is find $p$ and $q$.

$$X_t=(1-\phi B) X_t $$ $$(1-\phi B)X_t=(1-\phi B)(1-\tau B)Y_t=(1-\tau B)(1-\phi B)Y_t=(1-\tau B)(1-\theta B)e_t $$

$$1-\phi B)X_t=(1-\theta B)(1-\tau B)e_t$$

X_t=ARMA(1,2)

$p=1, q=2$

AR=$\phi$

MA = $\theta_1=\theta+\tau$, $\theta_2=-\theta \tau$

\pagebreak

### 5. (20 points) Simulate an AR(2) time series of length $n = 72$ with $\phi 1 = 0.7$ and $\phi 2 = −0.4$

#### (a) Calculate and plot the theoretical autocorrelation function for this model. Plot sufficient lags until the correlations are negligible. Hint: use ARMAacf() function.

```{r}

n<-75
phi<-c(0.75, -0.4)
lag.max <- 30

acf_model_1 <- ARMAacf(ar = phi, ma = numeric(0), lag.max = lag.max)

# Plot
plot(0:lag.max, acf_model_1, type = "h", lwd = 2,
     xlab = "Lag", ylab = "Theoretical ACF",
     main = "Theoretical ACF for AR(2): phi1=0.7, phi2=-0.4")
abline(h = 0, lty = 2)

```

\pagebreak

(b) Calculate and plot the sample ACF for your simulated series. How well do the values and patterns match the theoretical ACF of part (a)?

```{r}
y   <- arima.sim(model = list(ar = phi), n = n)

acf_sample_1   <- acf(y, lag.max = lag.max, plot = FALSE)


plot(0:lag.max, acf_model_1, type = "h", lwd = 2,
     xlab = "Lag", ylab = "ACF",
     main = "AR(2): Theoretical vs Sample ACF")
points(acf_sample_1$lag[,1,1], acf_sample_1$acf[,1,1], pch = 16)
abline(h = 0, lty = 2)

```

Sample ACF tracks the Theorical ACF with sampling noise.

\pagebreak

(c) What are the theoretical partial autocorrelations for this model? Hint: use ARMAacf(...,pacf = TRUE) function.

```{r}


pacf_model_1 <- ARMAacf(ar = phi, lag.max = lag.max, pacf = TRUE)

pacf_model_1

plot(1:lag.max, pacf_model_1, type = "h", lwd = 2,
     xlab = "Lag", ylab = "Theoretical PACF",
     main = "Theoretical PACF for AR(2): phi1=0.7, phi2=-0.4")
abline(h = 0, lty = 2)

```

\pagebreak

(d) Calculate and plot the sample PACF for your simulated series. How well do the values and patterns match the theoretical ACF of part (c)?

```{r}

pacf_sample_1 <- pacf(y, lag.max = lag.max, plot = FALSE)


plot(1:lag.max, pacf_model_1, type = "h", lwd = 2,
     xlab = "Lag", ylab = "PACF",
     main = "AR(2): Theoretical vs Sample PACF (n = 72)")
points(pacf_sample_1$lag[,1,1], pacf_sample_1$acf[,1,1], pch = 16)
abline(h = 0, lty = 2)

```

Large spikes at $Lags 1=0.5$ and $Lag 2=-0.4$ matches the theorical PACF
